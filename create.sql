create table tb_controlled_sku (name varchar(255), sku varchar(255) not null, primary key (sku));
create table tb_customer (email varchar(255) not null, name varchar(255), phone varchar(255), primary key (email));
create table tb_order (number_recurrence integer, skipped integer, stock_released boolean not null, created_date timestamp(6), id bigint generated by default as identity, last_modified_date timestamp(6), amount_brl varchar(255), amount_original varchar(255), customer_email varchar(255), link varchar(255), order_rec varchar(255), order_status varchar(255), payment_date varchar(255), payment_method varchar(255), subscription_id varchar(255), primary key (id));
create table tb_product (quantity integer, total_price numeric(38,2), unit_price numeric(38,2), id bigint generated by default as identity, order_id bigint, category varchar(255), discount varchar(255), sku varchar(255), primary key (id));
create table tb_revenue_cache (total_revenue numeric(19,2) not null, year_month varchar(7) not null unique, id bigint generated by default as identity, last_updated_at timestamp(6) with time zone not null, primary key (id));
create table tb_role (id bigint generated by default as identity, authority varchar(255), primary key (id));
create table tb_shopify_sync_operation (quantity integer not null, retry_count integer not null, created_at timestamp(6) with time zone not null, executed_at timestamp(6) with time zone, id bigint generated by default as identity, error_message varchar(255), operation varchar(255) not null, sku varchar(255) not null, status varchar(255) not null, subscription_id varchar(255) not null, primary key (id));
create table tb_subscription (cancellation_date date, effective_cancellation_date date, "limit" integer, next_billing_date date, number_recurrences integer, created_at timestamp(6) with time zone not null, updated_at timestamp(6) with time zone not null, amount_brl varchar(255), billing_cycle varchar(255), customer_id varchar(255), id varchar(255) not null, order_token varchar(255), pix_rec_id varchar(255), shipping_cycle varchar(255), status varchar(255) check (status in ('AGUARDANDO_PRIMEIRO_PAGAMENTO','ATIVO','PAGAMENTO_PENDENTE','INATIVO_CANCELADO','EXPIRADO','PAUSADO','PAGAMENTO_ATRASADO')), primary key (id));
create table tb_user (id bigint generated by default as identity, email varchar(255), password varchar(255), primary key (id));
create table tb_user_role (role_id bigint not null, user_id bigint not null, primary key (role_id, user_id));
create index idx_year_month on tb_revenue_cache (year_month);
alter table if exists tb_order add constraint FKknj29d1k6k9yy4yseh4yfy8d6 foreign key (subscription_id) references tb_subscription;
alter table if exists tb_product add constraint FKqhmw4v8ett6y0kc6vprpjds00 foreign key (sku) references tb_controlled_sku;
alter table if exists tb_product add constraint FK74jnj2grq2t2vtv2xjquhs0ds foreign key (order_id) references tb_order;
alter table if exists tb_subscription add constraint FK2qntc8pehda99a3is38n24s8o foreign key (customer_id) references tb_customer;
alter table if exists tb_user_role add constraint FKea2ootw6b6bb0xt3ptl28bymv foreign key (role_id) references tb_role;
alter table if exists tb_user_role add constraint FK7vn3h53d0tqdimm8cp45gc0kl foreign key (user_id) references tb_user;
INSERT INTO tb_controlled_sku (sku, name) VALUES ('1204250_40961655799941','FROM REJECTION TO OBLIVION N2  EXTRA SPECIAL BITTER');
INSERT INTO tb_controlled_sku (sku, name) VALUES ('1204265_40956940746885','HOP LOVER');
INSERT INTO tb_controlled_sku (sku, name) VALUES ('1204266_40956938649733','SOURMIND MANGA E GOIABA');
INSERT INTO tb_controlled_sku (sku, name) VALUES ('1204319_40972310380677','METAMORPHOSE');
INSERT INTO tb_controlled_sku (sku, name) VALUES ('1204329_40961602846853','FROM REJECT TO OBLIVION N6  DRY STOUT');
INSERT INTO tb_controlled_sku (sku, name) VALUES ('12309_40972320047237','RED EYE');
INSERT INTO tb_controlled_sku (sku, name) VALUES ('1313_40956950937733','RIZOMA');
INSERT INTO tb_controlled_sku (sku, name) VALUES ('1324_40961985446021','MAGNUM OPUS');
INSERT INTO tb_controlled_sku (sku, name) VALUES ('13353_41174544220293','ABSENTIA');
INSERT INTO tb_controlled_sku (sku, name) VALUES ('1343_40956944679045','AMERICAN IPA');
INSERT INTO tb_controlled_sku (sku, name) VALUES ('13578_40972336300165','STRATA LOVER');
INSERT INTO tb_controlled_sku (sku, name) VALUES ('14050_40972330795141','SOURMIND PITAIA CAJU E MARACUJ√Å');
INSERT INTO tb_controlled_sku (sku, name) VALUES ('14528_40956939370629','HOP LITTLE LOVER');
INSERT INTO tb_controlled_sku (sku, name) VALUES ('14509_40952603738245','IPA');
INSERT INTO tb_controlled_sku (sku, name) VALUES ('14530_40956932423813','PILSEN');
INSERT INTO tb_controlled_sku (sku, name) VALUES ('14965_41173439905925','HEFE WEIZEN');
INSERT INTO tb_controlled_sku (sku, name) VALUES ('1669_40956942418053','AMERICAN PALE ALE');
INSERT INTO tb_controlled_sku (sku, name) VALUES ('447_40972342296709','REST IN PILZ');
INSERT INTO tb_controlled_sku (sku, name) VALUES ('6600_41368920588421','BOURBON VANILLA EUDER'); /*Inventory item ID 43458628583557 */;
INSERT INTO tb_controlled_sku (sku, name) VALUES ('3636_40972318441605','PROTOSTAR'); /*Inventory item ID 43055407169669 */;
INSERT INTO tb_role (id, authority) VALUES (1, 'ROLE_ADMIN');
INSERT INTO tb_role (id, authority) VALUES (2, 'ROLE_OPERATOR');
INSERT INTO tb_user (email, password) VALUES( 'gaspar@tartari.com', '$2a$10$k0qK5Rnu8mGN09KrCRNRHOaI3VkvenhNnt7iXPERNumfDY/uTinoi');
INSERT INTO tb_user (email, password) VALUES( 'lojavirtual@cervejariadogma.com.br ', '$2a$10$GsXkevlwMvEbxegWJqAPIOXVgOzqqHLbGWA.aG3118s6UFiGIU5q2');
INSERT INTO tb_user_role (user_id, role_id) VALUES (1, 1);
INSERT INTO tb_user_role (user_id, role_id) VALUES (2, 1);
